<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
<title>Semina AR</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
:root{--g:#2F5233;--g2:#4ade80;--gl:rgba(18,18,18,0.78);--gb:rgba(255,255,255,0.12);--f:'DM Sans',sans-serif}
html,body{width:100%;height:100%;overflow:hidden;background:#111;font-family:var(--f)}

/* CAMERA BG */
#cam{position:fixed;inset:0;z-index:0}
#vid{width:100%;height:100%;object-fit:cover;display:none}
#fbg{
  width:100%;height:100%;display:none;
  background:linear-gradient(175deg,#1a2e1c 0%,#0d1a0e 50%,#0a0f0a 100%);
  position:relative;overflow:hidden;
}
#fbg::after{
  content:'';position:absolute;inset:0;
  background-image:linear-gradient(rgba(255,255,255,0.028) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.028) 1px,transparent 1px);
  background-size:68px 68px;
}

/* ONE SCREEN AT A TIME */
.scr{position:fixed;inset:0;display:none;flex-direction:column;z-index:10}
.scr.on{display:flex}

/* TOPBAR */
.tb{display:flex;justify-content:space-between;align-items:center;padding:52px 16px 0;flex-shrink:0}
.lc{display:flex;align-items:center;gap:7px;background:var(--gl);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid var(--gb);border-radius:50px;padding:10px 15px;color:#fff;font-size:14px;font-weight:600}
.lc svg{width:13px;height:13px;opacity:.7;flex-shrink:0}
.bts{display:flex;gap:8px}
.ib{width:46px;height:46px;background:var(--gl);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid var(--gb);border-radius:13px;display:flex;align-items:center;justify-content:center;cursor:pointer;color:#fff}
.ib:active{opacity:.65}
.ib svg{width:19px;height:19px}

/* ── LOADING ── */
#sl{background:#050f06;align-items:center;justify-content:center;gap:18px}
.logo{font-size:28px;font-weight:800;color:#fff;letter-spacing:-1px}
.logo span{color:var(--g2)}
.spin{width:40px;height:40px;border:3px solid rgba(255,255,255,.1);border-top-color:var(--g2);border-radius:50%;animation:sp .8s linear infinite}
@keyframes sp{to{transform:rotate(360deg)}}
.ltx{color:rgba(255,255,255,.32);font-size:14px}

/* ── PERMISSION ── */
#sp2{background:rgba(0,0,0,.94);align-items:center;justify-content:center;gap:18px;padding:40px 30px;text-align:center}
.pi2{width:76px;height:76px;background:rgba(74,222,128,.1);border-radius:22px;display:flex;align-items:center;justify-content:center}
.pi2 svg{width:38px;height:38px;color:var(--g2)}
.pt{font-size:22px;font-weight:800;color:#fff;letter-spacing:-.3px}
.ps{font-size:14px;color:rgba(255,255,255,.4);line-height:1.65;max-width:255px}
.pb{padding:15px 42px;background:var(--g);color:#fff;border:none;border-radius:50px;font-size:16px;font-weight:700;font-family:var(--f);cursor:pointer}

/* ── SCAN ── */
#ss{position:relative}
.mid{flex:1;position:relative;display:flex;align-items:center;justify-content:center}

/* reticle */
.ret{width:110px;height:110px;position:relative;animation:rp 2.2s ease-in-out infinite;flex-shrink:0}
@keyframes rp{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.58;transform:scale(1.07)}}
.rc{position:absolute;width:25px;height:25px;border-color:#fff;border-style:solid}
.rc.tl{top:0;left:0;border-width:3px 0 0 3px;border-radius:7px 0 0 0}
.rc.tr{top:0;right:0;border-width:3px 3px 0 0;border-radius:0 7px 0 0}
.rc.bl{bottom:0;left:0;border-width:0 0 3px 3px;border-radius:0 0 0 7px}
.rc.br{bottom:0;right:0;border-width:0 3px 3px 0;border-radius:0 0 7px 0}
.ri{position:absolute;inset:0;display:flex;align-items:center;justify-content:center}
.ri svg{width:32px;height:32px;color:#fff;opacity:.85}

/* scan line */
.sl2{position:absolute;left:50%;transform:translateX(-50%);width:165px;height:2px;background:linear-gradient(90deg,transparent,var(--g2),transparent);animation:slm 2.2s ease-in-out infinite;border-radius:2px}
@keyframes slm{0%{top:18%;opacity:0}10%{opacity:1}90%{opacity:1}100%{top:82%;opacity:0}}

/* progress card */
.pc{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:var(--gl);backdrop-filter:blur(22px);-webkit-backdrop-filter:blur(22px);border:1px solid var(--gb);border-radius:18px;padding:14px 16px;width:236px;display:none;animation:pca .4s cubic-bezier(.34,1.56,.64,1)}
.pc.on{display:block}
@keyframes pca{from{opacity:0;transform:translate(-50%,-44%)}to{opacity:1;transform:translate(-50%,-50%)}}
.pch{display:flex;align-items:center;justify-content:space-between;margin-bottom:5px}
.pcl{display:flex;align-items:center;gap:7px;color:#fff;font-size:16px;font-weight:700}
.pck{width:20px;height:20px;background:var(--g2);border-radius:50%;display:flex;align-items:center;justify-content:center}
.pck svg{width:11px;height:11px;color:#000}
.pcn{width:30px;height:30px;background:rgba(255,255,255,.13);border-radius:9px;display:flex;align-items:center;justify-content:center;cursor:pointer}
.pcn svg{width:14px;height:14px;color:#fff}
.pcs{color:rgba(255,255,255,.42);font-size:12px}
.pcd{display:flex;gap:5px;margin-top:9px}
.d{height:4px;border-radius:2px;background:rgba(255,255,255,.16);flex:1;transition:background .5s}
.d.on{background:var(--g2)}
.d.dn{background:rgba(74,222,128,.38)}

/* final banner */
.lb{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:var(--gl);backdrop-filter:blur(22px);-webkit-backdrop-filter:blur(22px);border:1px solid var(--gb);border-radius:18px;padding:16px 18px;width:260px;display:none}
.lb.on{display:block}
.lbh{display:flex;align-items:center;justify-content:space-between}
.lbt{font-size:20px;font-weight:800;color:#fff}
.lbs{font-size:13px;color:rgba(255,255,255,.4);margin-top:3px}
.la{width:34px;height:34px;background:rgba(255,255,255,.12);border-radius:10px;display:flex;align-items:center;justify-content:center;cursor:pointer}
.la svg{width:16px;height:16px;color:#fff}

/* AR plant */
.ap{position:absolute;bottom:32%;left:50%;transform:translateX(-50%);display:none;flex-direction:column;align-items:center;animation:api .6s cubic-bezier(.34,1.56,.64,1)}
.ap.on{display:flex}
@keyframes api{from{opacity:0;transform:translateX(-50%) scale(.1)}to{opacity:1;transform:translateX(-50%) scale(1)}}
.psvg{width:86px;height:112px;filter:drop-shadow(0 10px 22px rgba(0,0,0,.6))}
.psh{width:92px;height:14px;background:radial-gradient(ellipse,rgba(0,0,0,.5) 0%,transparent 70%);filter:blur(5px);margin-top:-6px}

/* surface */
.su{position:absolute;bottom:26%;left:50%;transform:translateX(-50%) perspective(250px) rotateX(62deg);width:150px;height:82px;background:linear-gradient(135deg,rgba(74,222,128,.2),rgba(47,82,51,.14));border:1px solid rgba(74,222,128,.32);border-radius:7px;display:none}
.su.on{display:block}

/* toast */
.mt{position:absolute;bottom:22%;left:50%;transform:translateX(-50%);background:var(--gl);backdrop-filter:blur(22px);-webkit-backdrop-filter:blur(22px);border:1px solid var(--gb);border-radius:18px;padding:12px 16px;display:none;align-items:center;gap:12px;min-width:235px;animation:mta .35s cubic-bezier(.34,1.56,.64,1)}
.mt.on{display:flex}
@keyframes mta{from{opacity:0;transform:translateX(-50%) translateY(12px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}
.mti{width:42px;height:42px;background:#fff;border-radius:11px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.mti svg{width:20px;height:20px;color:#111}
.mtt{font-size:15px;font-weight:700;color:#fff}
.mts{font-size:11px;color:rgba(255,255,255,.4);margin-top:2px}

/* arrows */
.ar{position:absolute;display:none;pointer-events:none}
.ar.on{display:flex}
.cv{color:rgba(74,222,128,.7);animation:cva .85s ease-in-out infinite}
.cv:nth-child(2){animation-delay:.15s;opacity:.5}
.cv:nth-child(3){animation-delay:.3s;opacity:.26}
@keyframes cva{0%,100%{transform:translateY(0)}50%{transform:translateY(-5px)}}
@keyframes cvl{0%,100%{transform:translateX(0)}50%{transform:translateX(-5px)}}

/* ── CUSTOMIZE ── */
#sc2{justify-content:space-between}
.sp{flex:1}
.bs{background:#fff;border-radius:28px 28px 0 0;padding:12px 22px 44px;flex-shrink:0;animation:bsu .5s cubic-bezier(.34,1.56,.64,1)}
@keyframes bsu{from{transform:translateY(100%)}to{transform:translateY(0)}}
.bh{width:40px;height:4px;background:#e5e5e5;border-radius:2px;margin:0 auto 18px}
.bti{font-size:17px;font-weight:700;color:#111;margin-bottom:13px}
.po{display:flex;gap:9px;margin-bottom:22px;flex-wrap:wrap}
.pob{padding:9px 17px;border:1.5px solid #e5e5e5;border-radius:50px;background:#fff;font-size:14px;font-weight:500;color:#555;cursor:pointer;font-family:var(--f);transition:all .2s}
.pob.on{border-color:var(--g);background:var(--g);color:#fff}
.sr2{display:flex;align-items:center;justify-content:space-between;margin-bottom:11px}
.sl3{font-size:15px;font-weight:600;color:#111}
.sv{font-size:14px;color:#999;font-weight:500}
.st{position:relative;width:100%;height:6px;background:#eee;border-radius:3px;margin-bottom:26px}
.sf{height:100%;background:var(--g);border-radius:3px;width:60%;transition:width .1s}
input[type=range]{position:absolute;inset:-8px 0;width:100%;opacity:0;cursor:pointer;height:22px}
.stb{position:absolute;top:50%;left:60%;transform:translate(-50%,-50%);width:20px;height:20px;background:#fff;border:2px solid var(--g);border-radius:50%;pointer-events:none;box-shadow:0 2px 8px rgba(0,0,0,.15);transition:left .1s}
.cb{width:100%;padding:17px;background:var(--g);color:#fff;border:none;border-radius:50px;font-size:17px;font-weight:700;font-family:var(--f);cursor:pointer}
.cb:active{opacity:.88}

/* ── RECOMMEND ── */
#sr2{justify-content:space-between}
.lca{margin:16px 16px 0;background:var(--gl);backdrop-filter:blur(22px);-webkit-backdrop-filter:blur(22px);border:1px solid var(--gb);border-radius:18px;padding:16px 18px;display:flex;align-items:center;justify-content:space-between;flex-shrink:0}
.lca .lt{font-size:20px;font-weight:800;color:#fff}
.lca .ls{font-size:13px;color:rgba(255,255,255,.4);margin-top:3px}
.rs{background:var(--gl);backdrop-filter:blur(28px);-webkit-backdrop-filter:blur(28px);border:1px solid var(--gb);border-radius:28px 28px 0 0;padding:12px 22px 50px;flex-shrink:0;animation:bsu .5s cubic-bezier(.34,1.56,.64,1)}
.rt{font-size:20px;font-weight:700;color:#fff;margin-bottom:14px}
.pcs{display:flex;gap:12px;overflow-x:auto;padding-bottom:6px;-webkit-overflow-scrolling:touch;scrollbar-width:none}
.pcs::-webkit-scrollbar{display:none}
.pc2{background:#fff;border-radius:18px;padding:12px;min-width:152px;flex-shrink:0;cursor:pointer;transition:transform .2s;overflow:visible}
.pc2:active{transform:scale(.95)}
.pc2 .pn{font-size:15px;font-weight:700;color:#111;margin-bottom:2px}
.pc2 .pst{font-size:12px;font-weight:600;color:#1F8A3D;margin-bottom:5px}
.pc2 .pd{font-size:11px;color:#999;line-height:1.4}
</style>
</head>
<body>

<!-- BG -->
<div id="cam">
  <video id="vid" autoplay playsinline muted></video>
  <div id="fbg"></div>
</div>

<!-- LOADING -->
<div class="scr on" id="sl">
  <div class="logo">semi<span>na</span> AR</div>
  <div class="spin"></div>
  <div class="ltx">Initializing…</div>
</div>

<!-- PERMISSION -->
<div class="scr" id="sp2">
  <div class="pi2">
    <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
      <path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"/>
      <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0z"/>
    </svg>
  </div>
  <div class="pt">Camera Access</div>
  <div class="ps">Semina AR needs your camera to place plants in your real space.</div>
  <button class="pb" onclick="reqCam()">Enable Camera</button>
</div>

<!-- SCAN -->
<div class="scr" id="ss">
  <div class="tb">
    <div class="lc">
      <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"/></svg>
      Balcony
    </div>
    <div class="bts">
      <div class="ib"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg></div>
      <div class="ib" onclick="go('sp2')"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg></div>
    </div>
  </div>
  <div class="mid">
    <div class="ret" id="ret">
      <div class="rc tl"></div><div class="rc tr"></div><div class="rc bl"></div><div class="rc br"></div>
      <div class="ri"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"/></svg></div>
    </div>
    <div class="sl2"></div>

    <!-- Progress card -->
    <div class="pc" id="pcard">
      <div class="pch">
        <div class="pcl">
          <div class="pck"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"/></svg></div>
          Balcony
        </div>
        <div class="pcn"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5"/></svg></div>
      </div>
      <div class="pcs" id="psub">1/3 surface Detected</div>
      <div class="pcd">
        <div class="d on" id="d1"></div>
        <div class="d" id="d2"></div>
        <div class="d" id="d3"></div>
      </div>
    </div>

    <!-- Final banner -->
    <div class="lb" id="lb">
      <div class="lbh">
        <div class="lbt">Balcony</div>
        <div class="la" onclick="go('sc2')"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 19.5l15-15m0 0H8.25m11.25 0v11.25"/></svg></div>
      </div>
      <div class="lbs">3/3 surface</div>
    </div>

    <!-- Surface + Plant -->
    <div class="su" id="su"></div>
    <div class="ap" id="ap">
      <svg class="psvg" viewBox="0 0 100 130" fill="none">
        <ellipse cx="50" cy="122" rx="19" ry="5" fill="#000" opacity=".22"/>
        <path d="M36 102 L39 124 L61 124 L64 102 Z" fill="#9B7A52"/>
        <ellipse cx="50" cy="102" rx="15" ry="4" fill="#B8966E"/>
        <path d="M50 102 L50 70" stroke="#3E6B44" stroke-width="3.5" stroke-linecap="round"/>
        <path d="M50 84 Q33 70 25 52 Q41 56 50 78" fill="#1B5E20" opacity=".95"/>
        <path d="M50 78 Q67 62 75 44 Q59 50 50 74" fill="#2E7D32" opacity=".95"/>
        <path d="M50 74 Q44 58 47 40 Q56 52 50 72" fill="#388E3C"/>
        <path d="M50 74 Q56 56 53 36 Q45 50 50 72" fill="#43A047"/>
        <path d="M50 70 Q47 56 50 42 Q53 56 50 70" fill="#66BB6A"/>
      </svg>
      <div class="psh"></div>
    </div>

    <!-- Forward arrows -->
    <div class="ar" id="af" style="bottom:29%;left:50%;transform:translateX(-50%);flex-direction:column;gap:3px">
      <svg class="cv" width="28" height="17" viewBox="0 0 28 17" fill="currentColor"><path d="M14 0l14 17H0z"/></svg>
      <svg class="cv" width="28" height="17" viewBox="0 0 28 17" fill="currentColor"><path d="M14 0l14 17H0z"/></svg>
      <svg class="cv" width="28" height="17" viewBox="0 0 28 17" fill="currentColor"><path d="M14 0l14 17H0z"/></svg>
    </div>

    <!-- Left arrows -->
    <div class="ar" id="al" style="bottom:34%;left:18%;transform:translateX(-50%);flex-direction:row;gap:3px">
      <svg class="cv" width="17" height="28" viewBox="0 0 17 28" fill="currentColor" style="animation-name:cvl"><path d="M17 14L0 0v28z"/></svg>
      <svg class="cv" width="17" height="28" viewBox="0 0 17 28" fill="currentColor" style="animation-name:cvl"><path d="M17 14L0 0v28z"/></svg>
      <svg class="cv" width="17" height="28" viewBox="0 0 17 28" fill="currentColor" style="animation-name:cvl"><path d="M17 14L0 0v28z"/></svg>
    </div>

    <!-- Toast -->
    <div class="mt" id="mt">
      <div class="mti" id="mti"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 10.5L12 3m0 0l7.5 7.5M12 3v18"/></svg></div>
      <div>
        <div class="mtt" id="mtt">Move forward 12cm</div>
        <div class="mts">Slowly pan your phone</div>
      </div>
    </div>
  </div>
</div>

<!-- CUSTOMIZE -->
<div class="scr" id="sc2">
  <div class="tb">
    <div class="lc"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"/></svg>Balcony</div>
    <div class="bts">
      <div class="ib"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/></svg></div>
      <div class="ib" onclick="go('ss')"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg></div>
    </div>
  </div>
  <div class="sp"></div>
  <div class="bs">
    <div class="bh"></div>
    <div class="bti">Change Pot</div>
    <div class="po">
      <button class="pob on" onclick="selP(this)">plastic</button>
      <button class="pob" onclick="selP(this)">clay</button>
      <button class="pob" onclick="selP(this)">ceramic</button>
      <button class="pob" onclick="selP(this)">grow bag</button>
    </div>
    <div class="sr2"><div class="sl3">Size</div><div class="sv" id="sv">60%</div></div>
    <div class="st">
      <div class="sf" id="sf"></div>
      <div class="stb" id="stb"></div>
      <input type="range" min="10" max="100" value="60" oninput="updS(this)"/>
    </div>
    <button class="cb" onclick="go('sr2');loadP()">Confirm Plant</button>
  </div>
</div>

<!-- RECOMMEND -->
<div class="scr" id="sr2">
  <div class="tb">
    <div class="lc"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"/></svg>Balcony</div>
    <div class="bts">
      <div class="ib"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/></svg></div>
      <div class="ib" onclick="go('ss')"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg></div>
    </div>
  </div>
  <div class="lca">
    <div><div class="lt">Balcony</div><div class="ls">3/3 surface</div></div>
    <div class="la" onclick="go('sc2')"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 19.5l15-15m0 0H8.25m11.25 0v11.25"/></svg></div>
  </div>
  <div class="sp"></div>
  <div class="rs">
    <div class="bh" style="background:rgba(255,255,255,.18)"></div>
    <div class="rt">Recommended Plants</div>
    <div class="pcs" id="pcs"><div style="color:rgba(255,255,255,.35);font-size:14px;padding:10px 0">Loading…</div></div>
  </div>
</div>

<style>@keyframes cvl{0%,100%{transform:translateX(0)}50%{transform:translateX(-5px)}}</style>

<script>
const SU='https://eqhgcnzyiwgdtevxdehg.supabase.co';
const SK='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVxaGdjbnp5aXdnZHRldnhkZWhnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk2NTcyNTgsImV4cCI6MjA4NTIzMzI1OH0.7TVUKQCStGSK5-H6eNicMHY8weOo8eAtEdDpbROX810';

function go(id){document.querySelectorAll('.scr').forEach(s=>s.classList.remove('on'));document.getElementById(id).classList.add('on')}

async function startCam(){
  try{
    const s=await navigator.mediaDevices.getUserMedia({video:{facingMode:'environment',width:{ideal:1920},height:{ideal:1080}}});
    document.getElementById('vid').srcObject=s;
    document.getElementById('vid').style.display='block';
    document.getElementById('fbg').style.display='none';
  }catch(e){
    document.getElementById('vid').style.display='none';
    document.getElementById('fbg').style.display='block';
  }
  go('ss');runScan();
}
function reqCam(){startCam()}

function runScan(){
  setTimeout(()=>{document.getElementById('pcard').classList.add('on');step(1)},1500);
  setTimeout(()=>toast('f'),2500);
  setTimeout(()=>{hideT();plant();step(2)},4500);
  setTimeout(()=>toast('l'),5500);
  setTimeout(()=>{hideT();step(3)},7500);
  setTimeout(()=>{document.getElementById('pcard').classList.remove('on');document.getElementById('lb').classList.add('on')},8500);
}

function step(n){
  const s=['1/3 surface Detected','2/3 surface Detected','3/3 surface Detected'];
  document.getElementById('psub').textContent=s[n-1];
  for(let i=1;i<=3;i++){const d=document.getElementById('d'+i);d.className='d';if(i<n)d.classList.add('dn');else if(i===n)d.classList.add('on')}
}

function plant(){
  document.getElementById('su').classList.add('on');
  document.getElementById('ap').classList.add('on');
  document.getElementById('ret').style.opacity='0.22';
}

function toast(dir){
  const t=document.getElementById('mt');
  const ti=document.getElementById('mti');
  const tt=document.getElementById('mtt');
  if(dir==='f'){
    tt.textContent='Move forward 12cm';
    ti.innerHTML='<svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 10.5L12 3m0 0l7.5 7.5M12 3v18"/></svg>';
    document.getElementById('af').classList.add('on');
  }else{
    tt.textContent='Move left 12cm';
    ti.innerHTML='<svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"/></svg>';
    document.getElementById('al').classList.add('on');
  }
  t.classList.add('on');
}
function hideT(){document.getElementById('mt').classList.remove('on');document.getElementById('af').classList.remove('on');document.getElementById('al').classList.remove('on')}

function selP(b){document.querySelectorAll('.pob').forEach(x=>x.classList.remove('on'));b.classList.add('on')}
function updS(i){const v=i.value;document.getElementById('sv').textContent=v+'%';document.getElementById('sf').style.width=v+'%';document.getElementById('stb').style.left=v+'%'}

function pSVG(){return`<svg viewBox="0 0 80 80" fill="none" width="64" height="64" style="display:block;margin:0 auto 8px"><ellipse cx="40" cy="72" rx="13" ry="3.5" fill="#000" opacity=".18"/><path d="M30 64 L32 76 L48 76 L50 64 Z" fill="#9B7A52"/><ellipse cx="40" cy="64" rx="11" ry="3" fill="#B8966E"/><path d="M40 64 L40 44" stroke="#3E6B44" stroke-width="2.5" stroke-linecap="round"/><path d="M40 53 Q28 44 22 33 Q33 36 40 49" fill="#1B5E20"/><path d="M40 49 Q52 40 58 29 Q47 32 40 46" fill="#2E7D32"/><path d="M40 46 Q37 36 40 26 Q43 36 40 46" fill="#66BB6A"/></svg>`}

async function loadP(){
  const c=document.getElementById('pcs');
  try{
    const r=await fetch(`${SU}/rest/v1/plant_scans?select=plant_name,health_status,care_tips&order=created_at.desc&limit=6`,{headers:{'apikey':SK,'Authorization':`Bearer ${SK}`}});
    const d=await r.json();
    if(d&&d.length>0)renderP(d);else fallP();
  }catch(e){fallP()}
}

function renderP(pl){
  const c=document.getElementById('pcs');c.innerHTML='';
  pl.forEach(p=>{
    const el=document.createElement('div');el.className='pc2';
    const t=(p.care_tips?.[0]??'Keep in indirect light').substring(0,45);
    el.innerHTML=pSVG()+`<div class="pn">${p.plant_name??'Plant'}</div><div class="pst">${p.health_status??'Healthy'}</div><div class="pd">${t}…</div>`;
    c.appendChild(el);
  });
}

function fallP(){
  const pl=[{n:'Rubber Plant',s:'Healthy',d:'Thrives in indirect light'},{n:'Peace Lily',s:'Healthy',d:'Low light tolerant'},{n:'Pothos',s:'Healthy',d:'Very easy to care for'},{n:'Snake Plant',s:'Healthy',d:'Drought tolerant'}];
  const c=document.getElementById('pcs');c.innerHTML='';
  pl.forEach(p=>{const el=document.createElement('div');el.className='pc2';el.innerHTML=pSVG()+`<div class="pn">${p.n}</div><div class="pst">${p.s}</div><div class="pd">${p.d}</div>`;c.appendChild(el)});
}

window.addEventListener('load',()=>{
  setTimeout(async()=>{
    try{
      const s=await navigator.mediaDevices.getUserMedia({video:{facingMode:'environment'}});
      document.getElementById('vid').srcObject=s;
      document.getElementById('vid').style.display='block';
      document.getElementById('fbg').style.display='none';
      go('ss');runScan();
    }catch(e){go('sp2')}
  },1400);
});
</script>
</body>
</html>